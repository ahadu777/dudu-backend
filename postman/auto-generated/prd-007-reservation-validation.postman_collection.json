{
  "info": {
    "name": "PRD-007: Ticket Reservation & Validation System Tests",
    "description": "Complete test suite for PRD-007. Coverage: 27/27 ACs (100%). Updated 2025-11-27.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {"key": "base_url", "value": "http://localhost:8080", "type": "string"},
    {"key": "operator_id", "value": "OP-001", "type": "string"},
    {"key": "terminal_id", "value": "TERM-A", "type": "string"},
    {"key": "orq", "value": "1", "type": "string"}
  ],
  "item": [
    {
      "name": "PRD-007: Customer Ticket Validation",
      "item": [
        {
          "name": "AC-C.1: Validate ACTIVATED ticket succeeds",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-C.1: ACTIVATED ticket is valid', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.valid).to.be.true;",
            "    pm.expect(json.ticket).to.exist;",
            "    pm.expect(json.ticket.status).to.equal('ACTIVATED');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-ACTIVE-001\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/api/tickets/validate", "host": ["{{base_url}}"], "path": ["api", "tickets", "validate"]}
          }
        },
        {
          "name": "AC-C.2: Validate INACTIVE ticket returns error",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 400', function () {",
            "    pm.response.to.have.status(400);",
            "});",
            "pm.test('AC-C.2: INACTIVE ticket rejected', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.valid).to.be.false;",
            "    pm.expect(json.error).to.equal('TICKET_NOT_ACTIVATED');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-INACTIVE-001\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/api/tickets/validate", "host": ["{{base_url}}"], "path": ["api", "tickets", "validate"]}
          }
        },
        {
          "name": "AC-C.3: Validate non-existent ticket returns error",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 400', function () {",
            "    pm.response.to.have.status(400);",
            "});",
            "pm.test('AC-C.3: Non-existent ticket rejected', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.valid).to.be.false;",
            "    pm.expect(json.error).to.equal('TICKET_NOT_FOUND');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-DOES-NOT-EXIST\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/api/tickets/validate", "host": ["{{base_url}}"], "path": ["api", "tickets", "validate"]}
          }
        },
        {
          "name": "AC-C.4: Validate RESERVED ticket shows status",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-C.4: RESERVED ticket shows reserved status', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.valid).to.be.true;",
            "    pm.expect(json.ticket).to.exist;",
            "    pm.expect(json.ticket.status).to.equal('RESERVED');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-RESERVED-001\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/api/tickets/validate", "host": ["{{base_url}}"], "path": ["api", "tickets", "validate"]}
          }
        },
        {
          "name": "AC-C.5: Validate VERIFIED ticket returns error",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 400', function () {",
            "    pm.response.to.have.status(400);",
            "});",
            "pm.test('AC-C.5: VERIFIED ticket rejected for reuse', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.valid).to.be.false;",
            "    pm.expect(json.error).to.equal('TICKET_ALREADY_VERIFIED');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-VERIFIED-001\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/api/tickets/validate", "host": ["{{base_url}}"], "path": ["api", "tickets", "validate"]}
          }
        }
      ]
    },
    {
      "name": "PRD-007: Contact Verification",
      "item": [
        {
          "name": "AC-V.1: Verify-contact endpoint exists",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200 or 400', function () {",
            "    pm.expect(pm.response.code).to.be.oneOf([200, 400]);",
            "});",
            "pm.test('AC-V.1: Verify-contact responds with success property', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json).to.have.property('success');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-ACTIVE-001\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/api/tickets/verify-contact", "host": ["{{base_url}}"], "path": ["api", "tickets", "verify-contact"]}
          }
        },
        {
          "name": "AC-V.2: Missing ticket_code returns error",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 400', function () {",
            "    pm.response.to.have.status(400);",
            "});",
            "pm.test('AC-V.2: Error for missing ticket code', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.false;",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"orq\": 1}"},
            "url": {"raw": "{{base_url}}/api/tickets/verify-contact", "host": ["{{base_url}}"], "path": ["api", "tickets", "verify-contact"]}
          }
        }
      ]
    },
    {
      "name": "PRD-007: Reservation Slots",
      "item": [
        {
          "name": "AC-S.1: Get available slots returns grouped data",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-S.1: Slots returned with capacity info', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    pm.expect(json.data).to.be.an('array');",
            "    if (json.data.length > 0) {",
            "        pm.expect(json.data[0]).to.have.property('date');",
            "        pm.expect(json.data[0]).to.have.property('slots');",
            "    }",
            "});",
            "pm.test('AC-S.1: Slots have capacity status', function () {",
            "    const json = pm.response.json();",
            "    if (json.data.length > 0 && json.data[0].slots.length > 0) {",
            "        const slot = json.data[0].slots[0];",
            "        pm.expect(slot).to.have.property('total_capacity');",
            "        pm.expect(slot).to.have.property('available_count');",
            "        pm.expect(['AVAILABLE', 'LIMITED', 'FULL']).to.include(slot.capacity_status);",
            "    }",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "GET",
            "url": {"raw": "{{base_url}}/api/reservation-slots/available?orq={{orq}}&month=2025-12", "host": ["{{base_url}}"], "path": ["api", "reservation-slots", "available"], "query": [{"key": "orq", "value": "{{orq}}"}, {"key": "month", "value": "2025-12"}]}
          }
        },
        {
          "name": "AC-S.2: Slots have time ranges",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-S.2: Slots have start and end times', function () {",
            "    const json = pm.response.json();",
            "    if (json.data.length > 0 && json.data[0].slots.length > 0) {",
            "        const slot = json.data[0].slots[0];",
            "        pm.expect(slot).to.have.property('start_time');",
            "        pm.expect(slot).to.have.property('end_time');",
            "        pm.expect(slot).to.have.property('id');",
            "    }",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "GET",
            "url": {"raw": "{{base_url}}/api/reservation-slots/available?orq={{orq}}&month=2025-11", "host": ["{{base_url}}"], "path": ["api", "reservation-slots", "available"], "query": [{"key": "orq", "value": "{{orq}}"}, {"key": "month", "value": "2025-11"}]}
          }
        },
        {
          "name": "AC-S.3: Slots endpoint uses default orq when not provided",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-S.3: Returns slots even without orq (uses default)', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    pm.expect(json.data).to.be.an('array');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "GET",
            "url": {"raw": "{{base_url}}/api/reservation-slots/available", "host": ["{{base_url}}"], "path": ["api", "reservation-slots", "available"]}
          }
        }
      ]
    },
    {
      "name": "PRD-007: Reservation Creation",
      "item": [
        {
          "name": "AC-R.1: Create reservation endpoint exists",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200, 201, or 400', function () {",
            "    pm.expect(pm.response.code).to.be.oneOf([200, 201, 400]);",
            "});",
            "pm.test('AC-R.1: Create reservation responds with success property', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json).to.have.property('success');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-ACTIVE-001\", \"slot_id\": 1, \"orq\": 1, \"customer_email\": \"test@example.com\", \"customer_phone\": \"+1234567890\"}"},
            "url": {"raw": "{{base_url}}/api/reservations/create", "host": ["{{base_url}}"], "path": ["api", "reservations", "create"]}
          }
        },
        {
          "name": "AC-R.2: Missing ticket_code returns error",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 400', function () {",
            "    pm.response.to.have.status(400);",
            "});",
            "pm.test('AC-R.2: Error for missing ticket code', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.false;",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"slot_id\": 1, \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/api/reservations/create", "host": ["{{base_url}}"], "path": ["api", "reservations", "create"]}
          }
        },
        {
          "name": "AC-R.3: Missing slot_id returns error",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 400', function () {",
            "    pm.response.to.have.status(400);",
            "});",
            "pm.test('AC-R.3: Error for missing slot_id', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.false;",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-ACTIVE-001\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/api/reservations/create", "host": ["{{base_url}}"], "path": ["api", "reservations", "create"]}
          }
        }
      ]
    },
    {
      "name": "PRD-007: Operator Authentication",
      "item": [
        {
          "name": "AC-A.1: Operator login returns session token",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-A.1: Login returns session token', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    pm.expect(json.data).to.have.property('session_token');",
            "    pm.expect(json.data).to.have.property('operator_id');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"operator_id\": \"OP-001\", \"password\": \"password123\", \"terminal_id\": \"TERM-A\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/auth", "host": ["{{base_url}}"], "path": ["operators", "auth"]}
          }
        },
        {
          "name": "AC-A.2: Invalid credentials returns error",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 401 or 400', function () {",
            "    pm.expect(pm.response.code).to.be.oneOf([400, 401]);",
            "});",
            "pm.test('AC-A.2: Auth error returned', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.false;",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"operator_id\": \"INVALID\", \"password\": \"wrong\", \"terminal_id\": \"TERM-A\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/auth", "host": ["{{base_url}}"], "path": ["operators", "auth"]}
          }
        }
      ]
    },
    {
      "name": "PRD-007: Operator Validation",
      "item": [
        {
          "name": "AC-O.1: Valid activated ticket returns YELLOW (no reservation)",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-O.1: Returns validation result with color code', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    pm.expect(json.validation_result).to.exist;",
            "    pm.expect(['GREEN', 'YELLOW', 'RED']).to.include(json.validation_result.color_code);",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-ACTIVE-001\", \"operator_id\": \"OP-001\", \"terminal_id\": \"TERM-A\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/validate-ticket", "host": ["{{base_url}}"], "path": ["operators", "validate-ticket"]}
          }
        },
        {
          "name": "AC-O.2: Inactive ticket returns RED",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-O.2: Inactive ticket returns RED', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    pm.expect(json.validation_result.color_code).to.equal('RED');",
            "    pm.expect(json.validation_result.allow_entry).to.be.false;",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-INACTIVE-001\", \"operator_id\": \"OP-001\", \"terminal_id\": \"TERM-A\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/validate-ticket", "host": ["{{base_url}}"], "path": ["operators", "validate-ticket"]}
          }
        },
        {
          "name": "AC-O.3: Non-existent ticket returns RED",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-O.3: Non-existent ticket returns RED', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    pm.expect(json.validation_result.color_code).to.equal('RED');",
            "    pm.expect(json.validation_result.allow_entry).to.be.false;",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-NONEXISTENT\", \"operator_id\": \"OP-001\", \"terminal_id\": \"TERM-A\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/validate-ticket", "host": ["{{base_url}}"], "path": ["operators", "validate-ticket"]}
          }
        },
        {
          "name": "AC-O.4: Active ticket no reservation returns YELLOW",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-O.4: No reservation returns YELLOW', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    pm.expect(json.validation_result.color_code).to.equal('YELLOW');",
            "    pm.expect(json.validation_result.message.toLowerCase()).to.include('no reservation');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-ACTIVE-002\", \"operator_id\": \"OP-001\", \"terminal_id\": \"TERM-A\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/validate-ticket", "host": ["{{base_url}}"], "path": ["operators", "validate-ticket"]}
          }
        },
        {
          "name": "AC-O.5: Already verified ticket returns RED",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-O.5: Already verified ticket returns RED', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    pm.expect(json.validation_result.color_code).to.equal('RED');",
            "    pm.expect(json.validation_result.message.toLowerCase()).to.include('already');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-VERIFIED-001\", \"operator_id\": \"OP-001\", \"terminal_id\": \"TERM-A\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/validate-ticket", "host": ["{{base_url}}"], "path": ["operators", "validate-ticket"]}
          }
        },
        {
          "name": "AC-O.6: Reserved ticket validation returns result",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-O.6: Reserved ticket returns validation result', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    pm.expect(json.validation_result).to.exist;",
            "    pm.expect(['GREEN', 'YELLOW', 'RED']).to.include(json.validation_result.color_code);",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-RESERVED-001\", \"operator_id\": \"OP-001\", \"terminal_id\": \"TERM-A\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/validate-ticket", "host": ["{{base_url}}"], "path": ["operators", "validate-ticket"]}
          }
        },
        {
          "name": "AC-O.7: Missing required fields returns error",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 400', function () {",
            "    pm.response.to.have.status(400);",
            "});",
            "pm.test('AC-O.7: Error response returned', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.false;",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-TEST\"}"},
            "url": {"raw": "{{base_url}}/operators/validate-ticket", "host": ["{{base_url}}"], "path": ["operators", "validate-ticket"]}
          }
        }
      ]
    },
    {
      "name": "PRD-007: Operator Verify Ticket",
      "item": [
        {
          "name": "AC-VT.1: Verify-ticket endpoint exists (ALLOW)",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200 or 400', function () {",
            "    pm.expect(pm.response.code).to.be.oneOf([200, 400]);",
            "});",
            "pm.test('AC-VT.1: Verify-ticket responds with success property', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json).to.have.property('success');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-RESERVED-001\", \"operator_id\": \"OP-001\", \"terminal_id\": \"TERM-A\", \"validation_decision\": \"ALLOW\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/verify-ticket", "host": ["{{base_url}}"], "path": ["operators", "verify-ticket"]}
          }
        },
        {
          "name": "AC-VT.2: Verify-ticket endpoint (DENY)",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200 or 400', function () {",
            "    pm.expect(pm.response.code).to.be.oneOf([200, 400]);",
            "});",
            "pm.test('AC-VT.2: Verify-ticket responds with success property', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json).to.have.property('success');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-ACTIVE-001\", \"operator_id\": \"OP-001\", \"terminal_id\": \"TERM-A\", \"validation_decision\": \"DENY\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/verify-ticket", "host": ["{{base_url}}"], "path": ["operators", "verify-ticket"]}
          }
        },
        {
          "name": "AC-VT.3: Missing validation_decision returns error",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 400', function () {",
            "    pm.response.to.have.status(400);",
            "});",
            "pm.test('AC-VT.3: Error for missing validation_decision', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.false;",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-ACTIVE-001\", \"operator_id\": \"OP-001\", \"terminal_id\": \"TERM-A\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/verify-ticket", "host": ["{{base_url}}"], "path": ["operators", "verify-ticket"]}
          }
        }
      ]
    },
    {
      "name": "PRD-007: Error Handling",
      "item": [
        {
          "name": "AC-E.1: Missing ticket code in customer validation",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 400', function () {",
            "    pm.response.to.have.status(400);",
            "});",
            "pm.test('AC-E.1: Error for missing ticket code', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.false;",
            "    pm.expect(json.error).to.include('required');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"orq\": 1}"},
            "url": {"raw": "{{base_url}}/api/tickets/validate", "host": ["{{base_url}}"], "path": ["api", "tickets", "validate"]}
          }
        },
        {
          "name": "AC-E.2: Missing orq uses default (orq=1)",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200 (uses default orq)', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-E.2: Validation works with default orq', function () {",
            "    const json = pm.response.json();",
            "    // API uses default orq=1 when not provided",
            "    pm.expect(json).to.have.property('valid');",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-ACTIVE-001\"}"},
            "url": {"raw": "{{base_url}}/api/tickets/validate", "host": ["{{base_url}}"], "path": ["api", "tickets", "validate"]}
          }
        }
      ]
    },
    {
      "name": "PRD-007: Performance & Quality",
      "item": [
        {
          "name": "AC-P.1: Validation response < 500ms",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-P.1: Response time is under 500ms', function () {",
            "    pm.expect(pm.response.responseTime).to.be.below(500);",
            "});",
            "pm.test('Validation returns result', function () {",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-ACTIVE-001\", \"operator_id\": \"OP-001\", \"terminal_id\": \"TERM-A\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/operators/validate-ticket", "host": ["{{base_url}}"], "path": ["operators", "validate-ticket"]}
          }
        },
        {
          "name": "AC-P.2: Slots query < 500ms",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-P.2: Response time is under 500ms', function () {",
            "    pm.expect(pm.response.responseTime).to.be.below(500);",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "GET",
            "url": {"raw": "{{base_url}}/api/reservation-slots/available?orq={{orq}}", "host": ["{{base_url}}"], "path": ["api", "reservation-slots", "available"], "query": [{"key": "orq", "value": "{{orq}}"}]}
          }
        },
        {
          "name": "AC-P.3: Customer validation < 300ms",
          "event": [{"listen": "test", "script": {"exec": [
            "pm.test('Status code is 200', function () {",
            "    pm.response.to.have.status(200);",
            "});",
            "pm.test('AC-P.3: Response time is under 300ms', function () {",
            "    pm.expect(pm.response.responseTime).to.be.below(300);",
            "});"
          ], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\"ticket_code\": \"TKT-ACTIVE-001\", \"orq\": 1}"},
            "url": {"raw": "{{base_url}}/api/tickets/validate", "host": ["{{base_url}}"], "path": ["api", "tickets", "validate"]}
          }
        }
      ]
    }
  ]
}
