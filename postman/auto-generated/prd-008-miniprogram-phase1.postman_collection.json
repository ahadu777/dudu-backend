{
  "info": {
    "_postman_id": "prd-008-miniprogram-phase1",
    "name": "PRD-008 DeepTravel 小程序 Phase 1 - Package Booking",
    "description": "PRD-008 小程序预约平台测试 - 覆盖 26 个验收标准 (Phase 1)\n\n## 覆盖率: 100% (26/26 AC)\n\n### 测试结构:\n0. 微信认证 (5 tests)\n1. 产品目录 (4 tests)\n2. 订单管理 (5 tests)\n3. 支付集成 (4 tests)\n4. 票券发放 (5 tests)\n5. 取消退款 (3 tests)\n\n### AC 映射: docs/test-coverage/prd-008-ac-mapping.yaml",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "2.0.0"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080"
    },
    {
      "key": "auth_token",
      "value": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MjEsImVtYWlsIjoiIiwiaWF0IjoxNzY2NDg4MDc0LCJleHAiOjE3NjcwOTI4NzR9.0uMoglshbbWWvRI3rnTFpzF7QsLU0jQkBQhKxqqEr9w"
    },
    {
      "key": "test_product_id",
      "value": "106"
    },
    {
      "key": "test_order_no",
      "value": ""
    },
    {
      "key": "test_order_id",
      "value": ""
    },
    {
      "key": "test_ticket_code",
      "value": ""
    }
  ],
  "item": [
    {
      "name": "0. Prerequisites - Auth Setup",
      "item": [
        {
          "name": "0.1 Auth Setup (Token pre-configured)",
          "description": "测试准备：验证服务器健康状态并确认用户认证令牌已配置",
          "x-flow": {
            "sequence": 0,
            "page": "system",
            "trigger": "auto:test-setup",
            "produces": [
              "auth_token",
              "test_order_no"
            ],
            "consumes": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Token is pre-configured in collection variables",
                  "// This request just verifies the server is available",
                  "pm.test(\"Server is healthy\", function() {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Auth token is configured\", function() {",
                  "    const token = pm.collectionVariables.get(\"auth_token\");",
                  "    pm.expect(token).to.be.a(\"string\");",
                  "    pm.expect(token.length).to.be.greaterThan(0);",
                  "    console.log(\"Using pre-configured auth token\");",
                  "});",
                  "",
                  "// Generate test order number",
                  "const orderNo = \"MP\" + Date.now() + Math.random().toString(36).substr(2, 6).toUpperCase();",
                  "pm.collectionVariables.set(\"test_order_no\", orderNo);",
                  "console.log(\"Generated test order_no:\", orderNo);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/healthz",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "healthz"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "F0. WeChat Authentication (merged from PRD-004)",
      "description": "PRD AC: Feature 0 - WeChat login with optional phone binding. Tests validation, error handling, and security controls.",
      "item": [
        {
          "name": "F0.1 WeChat Login - Empty Code (Validation)",
          "description": "用户授权微信登录时传入空授权码，系统拒绝并提示参数错误",
          "x-flow": {
            "sequence": 0,
            "page": "wechat-auth",
            "trigger": "button:微信登录",
            "produces": [],
            "consumes": []
          },
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/wechat/login",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "auth",
                "wechat",
                "login"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 400 (Bad Request)', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('Returns validation error', function () {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('code');",
                  "    pm.expect(data.code).to.equal('VALIDATION_ERROR');",
                  "});",
                  "",
                  "pm.test('Has error details', function () {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('message');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "F0.2 WeChat Login - Missing Code",
          "description": "用户授权微信登录时未传入授权码，系统拒绝并提示必填字段缺失",
          "x-flow": {
            "sequence": 0,
            "page": "wechat-auth",
            "trigger": "button:微信登录",
            "produces": [],
            "consumes": []
          },
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{base_url}}/auth/wechat/login",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "auth",
                "wechat",
                "login"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 400 (Bad Request)', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('Returns validation error for missing code', function () {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('code');",
                  "    pm.expect(data.code).to.equal('VALIDATION_ERROR');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "F0.3 WeChat Login - Invalid Code (WeChat Rejects)",
          "description": "用户传入过期或伪造的授权码，微信服务器拒绝验证",
          "x-flow": {
            "sequence": 0,
            "page": "wechat-auth",
            "trigger": "button:微信登录",
            "produces": [],
            "consumes": []
          },
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"INVALID_CODE_12345\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/wechat/login",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "auth",
                "wechat",
                "login"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 401 or 422 (WeChat rejects invalid code)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([401, 422]);",
                  "});",
                  "",
                  "pm.test('Returns auth failed error', function () {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('code');",
                  "    pm.expect(['WECHAT_AUTH_FAILED', 'INVALID_CODE']).to.include(data.code);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "F0.4 Phone Binding - No JWT Token",
          "description": "未登录用户尝试绑定手机号，系统要求先完成微信登录",
          "x-flow": {
            "sequence": 0,
            "page": "wechat-auth",
            "trigger": "button:绑定手机",
            "produces": [],
            "consumes": []
          },
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"PHONE_AUTH_CODE\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/wechat/phone",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "auth",
                "wechat",
                "phone"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 401 (Unauthorized)', function () {",
                  "    pm.response.to.have.status(401);",
                  "});",
                  "",
                  "pm.test('Returns unauthorized error', function () {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('code');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "F0.5 Phone Binding - Invalid JWT Token",
          "description": "用户使用伪造或过期的令牌尝试绑定手机号，系统拒绝操作",
          "x-flow": {
            "sequence": 0,
            "page": "wechat-auth",
            "trigger": "button:绑定手机",
            "produces": [],
            "consumes": []
          },
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer invalid.jwt.token"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"PHONE_AUTH_CODE\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/wechat/phone",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "auth",
                "wechat",
                "phone"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 401 (Unauthorized)', function () {",
                  "    pm.response.to.have.status(401);",
                  "});",
                  "",
                  "pm.test('Returns unauthorized error for invalid token', function () {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('code');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "F0.6 Login Response Time (<500ms)",
          "description": "验证微信登录接口在高并发场景下响应时间不超过 500 毫秒",
          "x-flow": {
            "sequence": 0,
            "page": "wechat-auth",
            "trigger": "auto:performance-test",
            "produces": [],
            "consumes": []
          },
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"PERF_TEST_CODE\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/wechat/login",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "auth",
                "wechat",
                "login"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Login response time <500ms', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.lessThan(500);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "A1. Product Catalog - Direct Channel",
      "description": "PRD AC: Display all active package products from direct channel",
      "item": [
        {
          "name": "A1.1 Get product list (default)",
          "description": "用户打开小程序首页，浏览可购买的游轮套餐列表",
          "x-flow": {
            "sequence": 1,
            "page": "product-list",
            "trigger": "auto:page-load",
            "produces": [],
            "consumes": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 200', function() { pm.response.to.have.status(200); });",
                  "",
                  "pm.test('Returns product array', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('products');",
                  "    pm.expect(data.products).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Has pagination info', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('total');",
                  "    pm.expect(data).to.have.property('page');",
                  "    pm.expect(data).to.have.property('page_size');",
                  "});",
                  "",
                  "pm.test('Products have required fields', function() {",
                  "    const data = pm.response.json();",
                  "    if (data.products.length > 0) {",
                  "        const p = data.products[0];",
                  "        pm.expect(p).to.have.property('id');",
                  "        pm.expect(p).to.have.property('name');",
                  "        pm.expect(p).to.have.property('base_price');",
                  "        pm.expect(p).to.have.property('availability');",
                  "        pm.expect(p).to.have.property('status');",
                  "    }",
                  "});",
                  "",
                  "pm.test('Products show availability from direct channel', function() {",
                  "    const data = pm.response.json();",
                  "    data.products.forEach(p => {",
                  "        pm.expect(p.availability).to.have.property('available');",
                  "        pm.expect(p.availability.available).to.be.a('number');",
                  "        pm.expect(p.availability.available).to.be.at.least(0);",
                  "    });",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/miniprogram/products",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "products"
              ]
            }
          }
        },
        {
          "name": "A1.2 Product list pagination",
          "description": "用户下拉刷新或翻页查看更多游轮套餐商品",
          "x-flow": {
            "sequence": 1,
            "page": "product-list",
            "trigger": "scroll:load-more",
            "produces": [],
            "consumes": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 200', function() { pm.response.to.have.status(200); });",
                  "",
                  "pm.test('Respects pagination params', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.page).to.equal(1);",
                  "    pm.expect(data.page_size).to.equal(5);",
                  "    pm.expect(data.products.length).to.be.at.most(5);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/miniprogram/products?page=1&limit=5",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "products"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "5"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "A2. Product Detail - Package Inclusions",
      "description": "PRD AC: Show package inclusions (ferry + dining + entertainment functions)",
      "item": [
        {
          "name": "A2.1 Get product detail - cruise package",
          "description": "用户点击商品卡片进入详情页，查看套餐包含的服务和权益",
          "x-flow": {
            "sequence": 2,
            "page": "product-detail",
            "trigger": "tap:product-card",
            "produces": [
              "test_product_id"
            ],
            "consumes": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 200', function() { pm.response.to.have.status(200); });",
                  "",
                  "pm.test('Returns product detail', function() {",
                  "    const p = pm.response.json();",
                  "    pm.expect(p).to.have.property('id');",
                  "    pm.expect(p).to.have.property('name');",
                  "    pm.expect(p).to.have.property('description');",
                  "    pm.expect(p).to.have.property('status');",
                  "});",
                  "",
                  "pm.test('Has pricing info', function() {",
                  "    const p = pm.response.json();",
                  "    pm.expect(p).to.have.property('base_price');",
                  "    pm.expect(p.base_price).to.be.a('number');",
                  "});",
                  "",
                  "pm.test('Has package functions/inclusions', function() {",
                  "    const p = pm.response.json();",
                  "    pm.expect(p).to.have.property('functions');",
                  "    pm.expect(p.functions).to.be.an('array');",
                  "    pm.expect(p.functions.length).to.be.greaterThan(0);",
                  "    // Each function has code, label, quantity",
                  "    p.functions.forEach(f => {",
                  "        pm.expect(f).to.have.property('function_code');",
                  "        pm.expect(f).to.have.property('label');",
                  "        pm.expect(f).to.have.property('quantity');",
                  "    });",
                  "});",
                  "",
                  "pm.test('Has availability info', function() {",
                  "    const p = pm.response.json();",
                  "    pm.expect(p).to.have.property('availability');",
                  "    pm.expect(p.availability).to.have.property('channel');",
                  "    pm.expect(p.availability.channel).to.equal('direct');",
                  "    pm.expect(p.availability).to.have.property('available');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/miniprogram/products/{{test_product_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "products",
                "{{test_product_id}}"
              ]
            }
          }
        },
        {
          "name": "A2.2 Product not found",
          "description": "用户通过分享链接访问已下架的商品时，系统提示商品不存在",
          "x-flow": {
            "sequence": 2,
            "page": "product-detail",
            "trigger": "deeplink:share",
            "produces": [],
            "consumes": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 404', function() { pm.response.to.have.status(404); });",
                  "pm.test('Returns NOT_FOUND error', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.code).to.equal('NOT_FOUND');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/miniprogram/products/99999",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "products",
                "99999"
              ]
            }
          }
        },
        {
          "name": "A2.3 Invalid product ID",
          "description": "用户访问非法商品链接（ID格式错误）时，系统返回参数错误",
          "x-flow": {
            "sequence": 2,
            "page": "product-detail",
            "trigger": "deeplink:invalid",
            "produces": [],
            "consumes": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 400', function() { pm.response.to.have.status(400); });",
                  "pm.test('Returns validation error', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.code).to.equal('INVALID_PRODUCT_ID');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/miniprogram/products/abc",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "products",
                "abc"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "A3. Inventory Availability",
      "description": "PRD AC: Inventory availability real-time display",
      "item": [
        {
          "name": "A3.1 Check availability (default)",
          "description": "用户进入商品详情页时，系统实时查询并显示当前库存状态",
          "x-flow": {
            "sequence": 2,
            "page": "product-detail",
            "trigger": "auto:page-load",
            "produces": [],
            "consumes": [
              "test_product_id"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 200', function() { pm.response.to.have.status(200); });",
                  "",
                  "pm.test('Returns availability info', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('product_id');",
                  "    pm.expect(data).to.have.property('available');",
                  "    pm.expect(data).to.have.property('is_available');",
                  "});",
                  "",
                  "pm.test('Availability is boolean', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.is_available).to.be.a('boolean');",
                  "});",
                  "",
                  "pm.test('Available count is number', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.available).to.be.a('number');",
                  "    pm.expect(data.available).to.be.at.least(0);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/miniprogram/products/{{test_product_id}}/availability",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "products",
                "{{test_product_id}}",
                "availability"
              ]
            }
          }
        },
        {
          "name": "A3.2 Check availability with quantity",
          "description": "用户选择出行人数后，系统检查所需数量是否有足够库存",
          "x-flow": {
            "sequence": 2,
            "page": "product-detail",
            "trigger": "input:quantity-change",
            "produces": [],
            "consumes": [
              "test_product_id"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 200', function() { pm.response.to.have.status(200); });",
                  "",
                  "pm.test('Checks requested quantity', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('requested_quantity');",
                  "    pm.expect(data.requested_quantity).to.equal(5);",
                  "});",
                  "",
                  "pm.test('is_available reflects quantity check', function() {",
                  "    const data = pm.response.json();",
                  "    if (data.available >= 5) {",
                  "        pm.expect(data.is_available).to.be.true;",
                  "    } else {",
                  "        pm.expect(data.is_available).to.be.false;",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/miniprogram/products/{{test_product_id}}/availability?quantity=5",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "products",
                "{{test_product_id}}",
                "availability"
              ],
              "query": [
                {
                  "key": "quantity",
                  "value": "5"
                }
              ]
            }
          }
        },
        {
          "name": "A3.3 Availability - product not found",
          "description": "查询已下架商品的库存时，系统返回商品不存在错误",
          "x-flow": {
            "sequence": 2,
            "page": "product-detail",
            "trigger": "auto:page-load",
            "produces": [],
            "consumes": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 404', function() { pm.response.to.have.status(404); });"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/miniprogram/products/99999/availability",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "products",
                "99999",
                "availability"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "A4. Order Creation (DB Required)",
      "description": "PRD AC: Dynamic pricing. NOTE: Requires USE_DATABASE=true",
      "item": [
        {
          "name": "A4.1 Create order - success",
          "description": "用户选择出行人类型和日期后，点击「立即预订」创建订单",
          "x-flow": {
            "sequence": 3,
            "page": "order-confirm",
            "trigger": "button:立即预订",
            "produces": [
              "test_order_id"
            ],
            "consumes": [
              "test_product_id",
              "test_order_no",
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Skip if server returns 500 (mock mode without DB)",
                  "if (pm.response.code === 500) {",
                  "    pm.test.skip('Order creation requires database mode');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Returns 201', function() { pm.response.to.have.status(201); });",
                  "",
                  "pm.test('Returns order with ID', function() {",
                  "    const order = pm.response.json();",
                  "    pm.expect(order).to.have.property('id');",
                  "    pm.expect(order).to.have.property('order_no');",
                  "    pm.expect(order.status).to.equal('pending');",
                  "    pm.collectionVariables.set('test_order_id', order.id);",
                  "});",
                  "",
                  "pm.test('Has pricing context', function() {",
                  "    const order = pm.response.json();",
                  "    pm.expect(order).to.have.property('pricing_context');",
                  "    const ctx = order.pricing_context;",
                  "    pm.expect(ctx).to.have.property('customer_breakdown');",
                  "    pm.expect(ctx).to.have.property('subtotal');",
                  "});",
                  "",
                  "pm.test('Total calculated correctly', function() {",
                  "    const order = pm.response.json();",
                  "    const ctx = order.pricing_context;",
                  "    pm.expect(order.total).to.equal(ctx.subtotal + ctx.addons_total);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"order_no\": \"{{test_order_no}}\",\n  \"product_id\": 106,\n  \"travel_date\": \"2025-12-20\",\n  \"customer_breakdown\": [\n    { \"customer_type\": \"adult\", \"count\": 2 },\n    { \"customer_type\": \"child\", \"count\": 1 }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/miniprogram/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "orders"
              ]
            }
          }
        },
        {
          "name": "A4.2 Error - missing order_no",
          "description": "提交订单时缺少订单号，系统返回必填字段缺失错误",
          "x-flow": {
            "sequence": 3,
            "page": "order-confirm",
            "trigger": "button:立即预订",
            "produces": [],
            "consumes": [
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 400', function() { pm.response.to.have.status(400); });",
                  "pm.test('Returns INVALID_REQUEST', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.code).to.equal('INVALID_REQUEST');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"product_id\": 106,\n  \"travel_date\": \"2025-12-20\",\n  \"customer_breakdown\": [{ \"customer_type\": \"adult\", \"count\": 1 }]\n}"
            },
            "url": {
              "raw": "{{base_url}}/miniprogram/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "orders"
              ]
            }
          }
        },
        {
          "name": "A4.3 Error - invalid customer type",
          "description": "用户选择了无效的客户类型（非成人/儿童/老人），系统拒绝创建订单",
          "x-flow": {
            "sequence": 3,
            "page": "order-confirm",
            "trigger": "button:立即预订",
            "produces": [],
            "consumes": [
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 400', function() { pm.response.to.have.status(400); });",
                  "pm.test('Returns INVALID_REQUEST', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.code).to.equal('INVALID_REQUEST');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"order_no\": \"MP_INVALID_{{$timestamp}}\",\n  \"product_id\": 106,\n  \"travel_date\": \"2025-12-20\",\n  \"customer_breakdown\": [{ \"customer_type\": \"invalid_type\", \"count\": 1 }]\n}"
            },
            "url": {
              "raw": "{{base_url}}/miniprogram/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "orders"
              ]
            }
          }
        },
        {
          "name": "A4.4 Error - unauthorized",
          "description": "未登录用户尝试下单时，系统要求先登录微信账户",
          "x-flow": {
            "sequence": 3,
            "page": "order-confirm",
            "trigger": "button:立即预订",
            "produces": [],
            "consumes": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 401', function() { pm.response.to.have.status(401); });"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"order_no\": \"MP_UNAUTH_{{$timestamp}}\",\n  \"product_id\": 106,\n  \"travel_date\": \"2025-12-20\",\n  \"customer_breakdown\": [{ \"customer_type\": \"adult\", \"count\": 1 }]\n}"
            },
            "url": {
              "raw": "{{base_url}}/miniprogram/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "orders"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "A5. Order Management (DB Required)",
      "description": "PRD AC: Order list and detail. NOTE: Requires USE_DATABASE=true",
      "item": [
        {
          "name": "A5.1 Get order list",
          "description": "用户进入「我的订单」页面，查看历史订单列表",
          "x-flow": {
            "sequence": 4,
            "page": "my-orders",
            "trigger": "tap:我的订单",
            "produces": [],
            "consumes": [
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 500) {",
                  "    pm.test.skip('Order list requires database mode');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Returns 200', function() { pm.response.to.have.status(200); });",
                  "",
                  "pm.test('Returns orders array', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('orders');",
                  "    pm.expect(data.orders).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Has pagination info', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('total');",
                  "    pm.expect(data).to.have.property('page');",
                  "    pm.expect(data).to.have.property('page_size');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/miniprogram/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "orders"
              ]
            }
          }
        },
        {
          "name": "A5.2 Get order detail",
          "description": "用户点击某个订单查看详情，包括票券信息和支付状态",
          "x-flow": {
            "sequence": 4,
            "page": "order-detail",
            "trigger": "tap:order-card",
            "produces": [],
            "consumes": [
              "test_order_id",
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 500) {",
                  "    pm.test.skip('Order detail requires database mode');",
                  "    return;",
                  "}",
                  "",
                  "// If no order was created (mock mode), test_order_id is empty",
                  "const orderId = pm.collectionVariables.get('test_order_id');",
                  "if (!orderId) {",
                  "    pm.test.skip('No order created to test detail');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Returns 200', function() { pm.response.to.have.status(200); });",
                  "",
                  "pm.test('Returns order detail', function() {",
                  "    const order = pm.response.json();",
                  "    pm.expect(order).to.have.property('id');",
                  "    pm.expect(order).to.have.property('order_no');",
                  "    pm.expect(order).to.have.property('status');",
                  "});",
                  "",
                  "pm.test('Has tickets array', function() {",
                  "    const order = pm.response.json();",
                  "    pm.expect(order).to.have.property('tickets');",
                  "    pm.expect(order.tickets).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/miniprogram/orders/{{test_order_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "orders",
                "{{test_order_id}}"
              ]
            }
          }
        },
        {
          "name": "A5.3 Error - unauthorized",
          "description": "未登录用户尝试访问订单列表时，系统要求先登录",
          "x-flow": {
            "sequence": 4,
            "page": "my-orders",
            "trigger": "tap:我的订单",
            "produces": [],
            "consumes": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 401', function() { pm.response.to.have.status(401); });"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/miniprogram/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "orders"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "A6. Simulate Payment (DB Required)",
      "description": "PRD AC: Simulate payment to generate tickets. NOTE: Requires USE_DATABASE=true",
      "item": [
        {
          "name": "A6.1 Simulate payment - success",
          "description": "用户在支付页面完成微信支付，系统回调生成电子票券",
          "x-flow": {
            "sequence": 5,
            "page": "checkout",
            "trigger": "callback:wechat-pay",
            "produces": [
              "test_ticket_code"
            ],
            "consumes": [
              "test_order_id",
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 500) {",
                  "    pm.test.skip('Simulate payment requires database mode');",
                  "    return;",
                  "}",
                  "",
                  "const orderId = pm.collectionVariables.get('test_order_id');",
                  "if (!orderId) {",
                  "    pm.test.skip('No order created to test payment');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Returns 200', function() { pm.response.to.have.status(200); });",
                  "",
                  "pm.test('Returns success message', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('message');",
                  "    pm.expect(data.message).to.include('成功');",
                  "});",
                  "",
                  "pm.test('Order status is paid/confirmed', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('order');",
                  "    pm.expect(['paid', 'confirmed']).to.include(data.order.status);",
                  "});",
                  "",
                  "pm.test('Tickets generated', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.order).to.have.property('tickets');",
                  "    pm.expect(data.order.tickets).to.be.an('array');",
                  "    pm.expect(data.order.tickets.length).to.be.greaterThan(0);",
                  "    // Save first ticket code for QR test",
                  "    if (data.order.tickets.length > 0) {",
                  "        pm.collectionVariables.set('test_ticket_code', data.order.tickets[0].ticket_code);",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/miniprogram/orders/{{test_order_id}}/simulate-payment",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "orders",
                "{{test_order_id}}",
                "simulate-payment"
              ]
            }
          }
        },
        {
          "name": "A6.2 Error - order not found",
          "description": "用户尝试支付不存在的订单时，系统提示订单未找到",
          "x-flow": {
            "sequence": 5,
            "page": "checkout",
            "trigger": "callback:wechat-pay",
            "produces": [],
            "consumes": [
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 404', function() { pm.response.to.have.status(404); });",
                  "pm.test('Returns ORDER_NOT_FOUND', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.code).to.equal('ORDER_NOT_FOUND');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/miniprogram/orders/99999/simulate-payment",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "orders",
                "99999",
                "simulate-payment"
              ]
            }
          }
        },
        {
          "name": "A6.3 Error - already paid (invalid status)",
          "description": "用户重复点击支付按钮，系统检测订单已支付并返回提示",
          "x-flow": {
            "sequence": 5,
            "page": "checkout",
            "trigger": "button:重复支付",
            "produces": [],
            "consumes": [
              "test_order_id",
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Simulate payment may be idempotent (returns 200) or reject (returns 400)",
                  "// Both behaviors are acceptable for already-paid orders",
                  "pm.test(\"Returns 200 or 400\", function() {",
                  "    pm.expect([200, 400]).to.include(pm.response.code);",
                  "});",
                  "",
                  "if (pm.response.code === 400) {",
                  "    pm.test(\"Returns INVALID_ORDER_STATUS when rejected\", function() {",
                  "        const data = pm.response.json();",
                  "        pm.expect(data.code).to.equal(\"INVALID_ORDER_STATUS\");",
                  "    });",
                  "} else {",
                  "    pm.test(\"Payment is idempotent (returns success message)\", function() {",
                  "        const data = pm.response.json();",
                  "        pm.expect(data).to.have.property(\"message\");",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/miniprogram/orders/{{test_order_id}}/simulate-payment",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "orders",
                "{{test_order_id}}",
                "simulate-payment"
              ]
            }
          }
        },
        {
          "name": "A6.4 Error - unauthorized",
          "description": "未登录用户尝试支付订单时，系统要求先登录",
          "x-flow": {
            "sequence": 5,
            "page": "checkout",
            "trigger": "callback:wechat-pay",
            "produces": [],
            "consumes": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 401', function() { pm.response.to.have.status(401); });"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/miniprogram/orders/1/simulate-payment",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "orders",
                "1",
                "simulate-payment"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "A7. Ticket QR Generation (DB Required)",
      "description": "PRD AC: Generate QR code for ticket. NOTE: Requires USE_DATABASE=true",
      "item": [
        {
          "name": "A7.1 Generate QR - success (default expiry)",
          "description": "用户打开「我的票券」页面，生成入场二维码",
          "x-flow": {
            "sequence": 6,
            "page": "my-tickets",
            "trigger": "tap:显示二维码",
            "produces": [],
            "consumes": [
              "test_ticket_code",
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 500) {",
                  "    pm.test.skip('QR generation requires database mode');",
                  "    return;",
                  "}",
                  "",
                  "const ticketCode = pm.collectionVariables.get('test_ticket_code');",
                  "if (!ticketCode) {",
                  "    pm.test.skip('No ticket available for QR test');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Returns 200', function() { pm.response.to.have.status(200); });",
                  "",
                  "pm.test('Returns success', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.success).to.be.true;",
                  "});",
                  "",
                  "pm.test('Has QR image', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('qr_image');",
                  "    pm.expect(data.qr_image).to.be.a('string');",
                  "    pm.expect(data.qr_image.length).to.be.greaterThan(100);",
                  "});",
                  "",
                  "pm.test('Has expiry info', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('expires_at');",
                  "    pm.expect(data).to.have.property('valid_for_seconds');",
                  "    pm.expect(data.valid_for_seconds).to.be.within(1795, 1805); // 30 minutes default",
                  "});",
                  "",
                  "pm.test('Has jti for invalidation', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('jti');",
                  "    pm.expect(data.jti).to.be.a('string');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{base_url}}/miniprogram/tickets/{{test_ticket_code}}/qr",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "tickets",
                "{{test_ticket_code}}",
                "qr"
              ]
            }
          }
        },
        {
          "name": "A7.2 Generate QR - custom expiry (60 min)",
          "description": "用户设置较长的二维码有效期（60分钟），适合排队入场场景",
          "x-flow": {
            "sequence": 6,
            "page": "my-tickets",
            "trigger": "tap:延长有效期",
            "produces": [],
            "consumes": [
              "test_ticket_code",
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 500) {",
                  "    pm.test.skip('QR generation requires database mode');",
                  "    return;",
                  "}",
                  "",
                  "const ticketCode = pm.collectionVariables.get('test_ticket_code');",
                  "if (!ticketCode) {",
                  "    pm.test.skip('No ticket available for QR test');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Returns 200', function() { pm.response.to.have.status(200); });",
                  "",
                  "pm.test('Respects custom expiry', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.valid_for_seconds).to.be.within(3595, 3605); // 60 minutes",
                  "});",
                  "",
                  "pm.test('New jti generated (old QR invalidated)', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data).to.have.property('jti');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"expiry_minutes\": 60 }"
            },
            "url": {
              "raw": "{{base_url}}/miniprogram/tickets/{{test_ticket_code}}/qr",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "tickets",
                "{{test_ticket_code}}",
                "qr"
              ]
            }
          }
        },
        {
          "name": "A7.3 Error - ticket not found",
          "description": "用户尝试为不存在的票券生成二维码，系统提示票券未找到",
          "x-flow": {
            "sequence": 6,
            "page": "my-tickets",
            "trigger": "tap:显示二维码",
            "produces": [],
            "consumes": [
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Skip if auth failed (no valid token)",
                  "const authToken = pm.collectionVariables.get('auth_token');",
                  "if (!authToken || pm.response.code === 401) {",
                  "    pm.test.skip('Requires valid auth token - WeChat login may have failed');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Returns 404', function() { pm.response.to.have.status(404); });",
                  "pm.test('Returns TICKET_NOT_FOUND', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.code).to.equal('TICKET_NOT_FOUND');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{base_url}}/miniprogram/tickets/NONEXISTENT123/qr",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "tickets",
                "NONEXISTENT123",
                "qr"
              ]
            }
          }
        },
        {
          "name": "A7.4 Error - invalid expiry",
          "description": "用户设置超出允许范围的二维码有效期，系统拒绝并提示有效期无效",
          "x-flow": {
            "sequence": 6,
            "page": "my-tickets",
            "trigger": "input:expiry-invalid",
            "produces": [],
            "consumes": [
              "test_ticket_code",
              "auth_token"
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Skip if auth failed (no valid token)",
                  "const authToken = pm.collectionVariables.get('auth_token');",
                  "if (!authToken || pm.response.code === 401) {",
                  "    pm.test.skip('Requires valid auth token - WeChat login may have failed');",
                  "    return;",
                  "}",
                  "",
                  "// Skip if no ticket available",
                  "const ticketCode = pm.collectionVariables.get('test_ticket_code');",
                  "if (!ticketCode) {",
                  "    pm.test.skip('No ticket available for expiry test');",
                  "    return;",
                  "}",
                  "",
                  "pm.test('Returns 400', function() { pm.response.to.have.status(400); });",
                  "pm.test('Returns INVALID_EXPIRY', function() {",
                  "    const data = pm.response.json();",
                  "    pm.expect(data.code).to.equal('INVALID_EXPIRY');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"expiry_minutes\": 9999 }"
            },
            "url": {
              "raw": "{{base_url}}/miniprogram/tickets/{{test_ticket_code}}/qr",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "tickets",
                "{{test_ticket_code}}",
                "qr"
              ]
            }
          }
        },
        {
          "name": "A7.5 Error - unauthorized",
          "description": "未登录用户尝试生成票券二维码，系统要求先登录",
          "x-flow": {
            "sequence": 6,
            "page": "my-tickets",
            "trigger": "tap:显示二维码",
            "produces": [],
            "consumes": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 401', function() { pm.response.to.have.status(401); });"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{base_url}}/miniprogram/tickets/TEST123/qr",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "miniprogram",
                "tickets",
                "TEST123",
                "qr"
              ]
            }
          }
        }
      ]
    }
  ]
}